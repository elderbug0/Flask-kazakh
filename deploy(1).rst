Өндіріске енгізу
====================

Оқулықтың бұл бөлігі сізде қолданбаны орналастырғыңыз келетін сервер бар деп болжайды. Ол тарату файлын құру және оны орнату жолына шолу жасайды, бірақ қандай сервер немесе бағдарламалық құралды пайдалану керектігі туралы егжей-тегжейлі айтылмайды.  Қолданбаны орналастырудың әртүрлі тәсілдерінің тізімін :doc:`/deploying/index` қараңыз.

Құрастыру және орнату
-----------------

Егер қолданбаңызды басқа жерде орналастырғыңыз келсе, дөңгелек (.whl) файлын жасайсыз. Ол үшін құрастыру құралын орнатып, пайдаланыңыз.

.. code-block:: none

    $ pip install build
    $ python -m build --wheel

Файлды dist/flaskr-1.0.0-py3-none-any.whl ішінен таба аласыз. Файл атауында {жоба атауы}-{нұсқа}-{Python тегі}-{abi тегі}-{платформа тегі} бар. 

Бұл файлды басқа құрылғыға көшіріп, жаңа виртуалды ортаны жасаңыз ``<install-create-env>``, содан кейін файлды pip көмегімен орнатыңыз.

.. code-block:: none

    $ pip install flaskr-1.0.0-py3-none-any.whl

`Pip` жобаңызды тәуелділіктерімен бірге орнатады.

Бұл басқа машина болғандықтан, дана қалтасында дерекқорды жасау үшін ``init-db`` қайта іске қосу керек.

    .. code-block:: text

        $ flask --app flaskr init-db

Flask оның орнатылғанын (өңдеуге болатын режимде емес) анықтағанда, ол дана қалтасы үшін басқа каталогты пайдаланады. Оны орнына ``.venv/var/flaskr-instance`` мекенжайынан таба аласыз.


Құпия кілтті орнатыңыз
------------------------

Оқулықтың басында сіз ``:data:`SECRET_KEY``` үшін әдепкі мән бердіңіз. Бұл өндірісте бірнеше кездейсоқ байтқа өзгертілуі керек. Әйтпесе, шабуылдаушылар сеанс cookie файлын немесе жеке кілтті пайдаланатын кез келген басқа файлды өзгерту үшін ``dev`` жалпы кілтін пайдалана алады.

Кездейсоқ құпия кілтті шығару үшін келесі пәрменді пайдалануға болады:

.. code-block:: none

    $ python -c 'import secrets; print(secrets.token_hex())'

    '192b9bdd22ab9ed4d12e236c78afcb9a393ec15f71bbf5dc987d54727823bcbf'

Бар болса, дана қалтасында config.py файлын жасаңыз. Жасалған мәнді оған көшіріңіз.

.. code-block:: python
    :caption: ``.venv/var/flaskr-instance/config.py``

    SECRET_KEY = '192b9bdd22ab9ed4d12e236c78afcb9a393ec15f71bbf5dc987d54727823bcbf'

Сондай-ақ мұнда кез келген басқа қажетті конфигурацияны орнатуға болады, бірақ Flaskr үшін тек ``SECRET_KEY`` қажет.


Өндірістік серверде іске қосу
----------------------------

Жалпыға қолжетімді болса және әзірлеуде болмаса, кірістірілген әзірлеу серверін (флэшті іске қосу) пайдаланбау керек. Әзірлеу серверін ыңғайлылық ретінде Werkzeug ұсынады, бірақ максималды өнімділікті, тұрақтылықты немесе қауіпсіздікті қамтамасыз етуге арналмаған.

Оның орнына WSGI өндіріс серверін пайдаланыңыз. Мысалы, `Waitress`_, қызметін пайдалану үшін алдымен оны виртуалды ортаға орнатыңыз:

.. code-block:: none

    $ pip install waitress

`Waitress` қолданбаңыз туралы айтуыңыз керек, бірақ ол flask run сияқты --app қолданбасын пайдаланбайды. Бағдарлама нысанын алу үшін импорттауды және қолданба зауытына қоңырау шалуды айту керек.

.. code-block:: none

    $ waitress-serve --call 'flaskr:create_app'

    Serving on http://0.0.0.0:8080

Қолданбаны орналастырудың әртүрлі тәсілдерінің тізімін ``:doc:`/deploying/index``` қараңыз. Даяшы - оқулық үшін таңдалған мысал ғана, себебі ол Windows және Linux жүйелерін қолдайды. Жобаңыз үшін таңдауға болатын көптеген басқа WSGI серверлері және орналастыру опциялары бар.

.. _Waitress: https://docs.pylonsproject.org/projects/waitress/en/stable/

Жалғастыру :doc:`next`.
